---
title: '[Week 06] Players and Teams Peformances'
author: Giuliano Sposito
date: '2020-10-21'
slug: week06_performances
categories:
  - evaluation
tags:
  - datascience
  - evaluation
  - points
  - projection
dropCap: yes
displayInMenu: no
displayInList: yes
resources:
- name: featuredImage
  src: week6_best_players.jpg
  params:
    description: War Games Tag Line
params:
  week: 6
  version: 5
---

<!--more-->


```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
# put rnotbook in the same workdir
knitr::opts_knit$set(root.dir = normalizePath(rprojroot::find_rstudio_root_file())) 
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r loadData}
library(tidyverse)
library(ggridges)
library(glue)
library(ggimage)

.week <- params$week
sim <- readRDS(glue("./data/simulation_v5_week{.week}_final.rds"))

player_performances <- inner_join(
  select(sim$players_sim, teamId, teamName, playerId, rosterSlotId, simulation.org),
  select(sim$players_stats, playerId, name, position, weekPts),
  by="playerId"
) %>% 
  unnest(weekPts) %>% 
  filter(week==6, rosterSlotId < 20) %>% 
  unnest(simulation.org) %>% 
  #filter(teamId==10) %>% 
  mutate(name=glue("{name} ({position})")) %>% 
  mutate(position2=factor(position, levels = c("QB","WR","RB", "TE", "K", "DEF"),ordered = T)) %>% 
  # mutate(name=fct_reorder(name, -as.integer(position2))) %>% 
  mutate(name=fct_reorder(name, simulation.org))

```

## Player Peformances

```{r printCharts, results="asis"}

chart <- player_performances %>% 
  ggplot(aes(x=simulation.org, y=name, fill=position)) +
  #geom_density_ridges() +
  stat_density_ridges(quantile_lines = TRUE, quantiles = c(0.1,0.5,0.9), scale=1, alpha=.6) +
  geom_point(aes(x=weekPts, y=name), color="black", fill="red", shape=24) +
  theme_ridges() +
  theme( legend.position = "none" ) +
  scale_y_discrete(expand=c(0.1,0)) +
  scale_x_continuous(expand = c(0.01,0)) +
  labs(x="points",y="") +
  facet_wrap(teamName~., scales = "free")

remp <- sim$teams %>% 
  select(teamId, name) %>% 
  arrange(name) %>% 
  split(1:nrow(.)) %>% 
  map(function(.team, .pperf){
    cat(glue("### {team}\n\n", team=.team$name))
    
    g <- .pperf %>% 
      filter(teamId==.team$teamId) %>% 
      ggplot(aes(x=simulation.org, y=name, fill=position)) +
        stat_density_ridges(quantile_lines = TRUE, quantiles = c(0.1,0.5,0.9), scale=1, alpha=.6) +
        geom_point(aes(x=weekPts, y=name), color="black", fill="red", shape=24) +
        theme_ridges() +
        theme( legend.position = "none" ) +
        scale_y_discrete(expand=c(0.1,0)) +
        scale_x_continuous(expand = c(0.01,0)) +
        labs(x="points",y="")
    
    print(g)
    cat("\n\n")
    
  }, .pperf = player_performances)

```

![Aaron Rodgers Pick Six](https://media.pff.com/2020/10/Jamel-Dean-TB1.gif)
